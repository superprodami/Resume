### 答辩讲稿

---

**自我介绍 & 实习职责**  
「各位大工号，我是平台开发组的袁闽。我从 7 月加入团队实习，主要的职责是研究和掌握 RTSP 取流以及 SDK 回放协议，并通过抓包分析来定位问题。  
在这过程中，我开发了两款工具：RTSP 取流异常分析工具和 SDK 回放协议异常分析工具。  
这两款工具把原本需要人工逐包分析的工作转化为自动化，大幅缩短了定位问题的时间，也提升了研发和测试同事的工作效率。工具里我也加入了异常检测、流程可视化、错误解释和解决建议等功能，让排障更准确、更高效。」

---

**第 3-6 页：关键任务 - RTSP 取流异常分析工具**  
「接下来为大家具体讲一下这两个工具，第一个是RTSP 取流异常分析工具。  
背景是这样的：在视频业务中，RTSP 是最常用的取流协议。但一旦出现取流失败，研发和测试往往要靠 Wireshark 一包包去分析，这不仅耗时，还需要有经验的人才能看懂。我的目标就是做一个工具，把这些重复性的人工工作自动化。

一开始调研了几种实现方案。Wireshark 功能最强，但太重、难以内嵌；scapy 协议扩展灵活，但处理大文件效率低；最终我选择了 dpkt，因为它轻量，而且解包速度快。  
开发过程中，我经常用 Wireshark 抓实际设备的包来对照，有不理解的地方一边查文档，一边比对，实在查不出来就请教导师。

然后整个软件的设计呢采用了**迭代式优化**的思路：第一个版本只要求能解析出最基本的交互信息，把数据“跑通”；第二步，我设计了一个逐层深入的交互界面，用户可以先看到概要，再逐步点进会话和码流分析，避免一上来就被一大堆数据淹没；接下来，通过测试，补充和晚上新功能，比如认证误判消解、超时检测、码流检测、甚至是无信令交互的场景；每次迭代，我都会用真实抓包来验证效果，保证工具不是“纸上谈兵”，而是真正能用在现场问题上的。而且这个后续还要持续进行的，因为他可能还会有部分边界场景处理不够全面，后续需要通过更多抓包样本不断优化异常规则。

除了功能优化，我还做了**抽象化设计**，不把逻辑写死在某个设备或端口上，而是提炼出通用逻辑。比如工具可以基于报文内容识别 RTSP/RTP/RTCP，而不是依赖端口；通过 URL 归一和会话合并，即便服务跑在 8554 或代理端口上，也能准确识别。

这样的迭代和抽象设计，让工具最终既能覆盖更多异常场景，具备了通用性和鲁棒性。原本需要半小时人工分析的工作，现在可能几分钟就能定位，还能给出明确的异常提示和解决建议。」

---

**第 7-9 页：关键任务 - SDK 回放协议分析工具**  
「第二个关键任务是 SDK 回放协议分析工具。  
背景是：SDK 回放协议非常复杂，涉及的命令和状态码多，研发同事在排查时，常常要翻协议文档，一条一条对比，非常耗时。我的目标是做一个工具，自动解析交互、提取回放码流、识别异常并生成分析报告。

在这里讲一下设计这个工具的过程中遇到的最主要的两个问题：

一个是这个SDK协议并不是像之前的RTSP原因是严格的一对一，一问一答的情况，而是一个订阅式的协议。比如说客户端发送了一个播放请求，服务端那边是会不断回应的，

为了解决这个问题，我设计了一个基于状态机的逻辑：

- 在回放状态下，工具会连续解析服务端响应，把 PS 流累积起来，直到检测到播放结束或异常；

- 在非回放状态下，解析普通控制命令响应，保持请求与响应的正确匹配，避免错乱。  
  这样就能很好地支持“一请求、多响应”的场景。

在开发过程中还遇到过另外一个问题：有个抓包文件始终无法解析，困扰了我不少时间。一开始，我怀疑是抓包文件本身有问题，比如文件损坏，或者某些数据包格式不符合标准。为了验证，我拿 Wireshark 打开这些文件，发现 Wireshark 是可以正常解析的。说明文件本身没问题，那就一定是我对协议头的解析不对。

自己的协议解析逻辑有 bug，尤其是私有协议的筛选部分可能把数据包过滤掉了。于是我加了大量调试打印，把解析流程一层层跟下来。结果发现他在解析IP的时候就解析不出来，但是问题是我自己抓的其他数据包都没问题，只有这个一个是有问题的。

最后，我用 Wireshark 自带的 capinfos 工具去看抓包文件的元信息，这才发现问题的根源：这些包并不是 Ethernet 类型，而是 Windows Loopback 类型。我之前的逻辑是写死在 Ethernet 上的，所以完全识别不出来。

确定问题后，我在工具里增加了 Loopback 的检测和处理逻辑，同时顺手扩展了对 IPv4/IPv6 的兼容，并支持 pcap 和 pcapng 两种格式。这样工具就能应对不同环境下的抓包文件了。

这个问题让我印象很深。因为前期我花了大量时间在错误的方向上，说明自己在排查时还是容易被第一印象限制住。后来解决掉之后，我也总结了一条经验：遇到协议解析问题时，不要一味盯着代码细节，要先确认链路层、抓包环境这些最基础的前提是不是正确。」

---

**第 10 页：最终成果总结**  
「这两款工具的成果：（直接演示工具效果）

- 第一，能完整解析协议交互，自动捕获异常；

- 第二，支持异常检测和状态跟踪，能自动提示并给出解决建议；

- 第三，数据提取和可视化，既能导出文件，也能交互显示结果；

- 第四，增强了兼容性和健壮性，支持多种抓包格式和非标准端口。  
  总体上，大幅提升了问题诊断效率，也降低了人工排查的成本。」

---

**总结反思**  
「这段实习下来，我最大的收获有两个方面。  
第一是专业能力。以前对网络协议的理解还停留在纸面，感觉都是书本知识。现在通过自己动手去写解析逻辑、做协议分析，尤其是遇到问题、去排查、去验证的过程中，我才真正体会到什么叫‘绝知此事要躬行’。比如说，Loopback 的问题就是一个很典型的例子，让我认识到协议栈的细节远比想象复杂。  
第二是心态和工作方法。一开始我总是很急，想着快点跑通，但在不断遇到棘手问题的过程中，我学会了耐心拆解，把问题分解成几个可能的点逐一验证。这个习惯对我帮助很大，让我不再害怕遇到复杂问题。

当然，也有反思。回顾整个实习过程，我觉得自己还是有不少不足。

另一方面是扩展性考虑不够。最开始写 RTSP 工具时，我的设计比较局限，后来不得不多次返工才让它更通用；另一方面是文档和总结做得不够及时。很多经验如果没有问题逼出来，其实很容易遗忘，等到后来再遇到类似问题，又要重新花时间去踩坑。

针对这些反思，我也总结出了一些改进措施和经验：

排查问题时不要被第一印象束缚、要抓住核心矛盾去定位问题 ，要多从不同维度去思考；

在写代码之前要多想一步，前置考虑扩展性和兼容性，避免后面大规模返工。并且要有验证意识，多加一些单元测试和异常场景模拟，用更全面的方式去保证健壮性；

养成边做边沉淀的习惯，不管是日志、修订记录，还是遇到的问题和解决办法，都尽量记下来，方便下次复用。

这些改进和沉淀，会让后续的工作中能更高效、更稳妥，也能少走一些弯路。」

---

**第 13 页：未来展望**  
「接下来，我希望把重心放在协助组内的实际工作上。  
继续巩固和学习相关知识，为团队多更多贡献，尽快能帮上小组成员。比如昨天早上就有一位大工找我，觉得我的exe的形式比较方便好用，不用配置环境 上手即用，让我帮忙把他的一个工具也打包一下。我就很开心啊，这不就是把现有的技能转化成对团队的实际帮助了嘛。

除了技术之外，沟通和协作能力同样重要。我也希望自己在这方面也能有所提升，能更快速地理解同事的需求，提供可行的解决方案。短期内是能支持小组日常工作，中期能承担一些模块开发或优化，长期来看，目标是成为团队中可靠的技术支撑，既能独立解决问题，也能带动小组进度

这是我对未来的规划，也是我希望努力的方向」

---

**第 14 页：结束页**  
「以上就是我的汇报，谢谢大家！」

---
